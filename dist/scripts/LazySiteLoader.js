import{j as e}from"../assets/jsx-runtime.CnDyYxjH.js";import{r as s}from"../assets/index.BiaIGwig.js";import{g as a,S as t}from"../assets/SiteListIsland.BQatP6M5.js";const r=({lang:s})=>e.jsx("div",{className:"lazy-placeholder",role:"status","aria-live":"polite",children:e.jsxs("div",{className:"lazy-content",children:[e.jsx("div",{className:"lazy-icon","aria-hidden":"true",children:e.jsx("img",{src:"/favicon.svg",alt:a(s,"lazyLoader.loading"),style:{width:"100%",height:"100%",objectFit:"contain"},loading:"lazy"})}),e.jsx("h4",{className:"lazy-heading",style:{textAlign:"center",display:"block"},children:a(s,"lazyLoader.loading")}),e.jsx("p",{className:"lazy-text",style:{textAlign:"center",display:"block"},children:a(s,"lazyLoader.loadingDescription")})]})}),l=({categoryId:l,categorySlug:i,lang:n,maxSites:o})=>{const[c,d]=s.useState([]),[h,g]=s.useState(!0),[y,x]=s.useState(null),[j,m]=s.useState(!1),u=s.useRef(null),v=s.useCallback((async()=>{try{g(!0),x(null);const e=await fetch(`/data/categories/${n}/${i}.json`);if(!e.ok)throw new Error(`Failed to load sites: ${e.status}`);const s=await e.json();d(s.slice(0,o))}catch(e){const s=e instanceof Error?e.message:"Unknown error";x(s),import.meta}finally{g(!1)}}),[i,n,o]);return s.useEffect((()=>{const e=u.current;if(!e)return;const s=new IntersectionObserver((e=>{const a=e[0];a?.isIntersecting&&(m(!0),v(),s.disconnect())}),{rootMargin:"400px",threshold:.01});return s.observe(e),()=>s.disconnect()}),[v]),e.jsx("div",{ref:u,"data-category-id":l,children:j?h?e.jsx(r,{lang:n}):y?e.jsx("div",{className:"lazy-error",role:"alert","aria-live":"assertive",children:e.jsxs("div",{className:"error-content",children:[e.jsx("div",{className:"error-icon","aria-hidden":"true",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126zM12 15.75h.007v.008H12v-.008z"})})}),e.jsx("h4",{className:"error-heading",style:{textAlign:"center",display:"block"},children:a(n,"lazyLoader.loadingFailed")}),e.jsx("p",{className:"error-message",style:{textAlign:"center",display:"block"},children:a(n,"lazyLoader.loadingFailedDescription")}),e.jsx("button",{onClick:v,className:"retry-button","aria-label":a(n,"lazyLoader.retryAriaLabel"),children:a(n,"lazyLoader.retry")})]})}):e.jsx(t,{sites:c,maxSites:o}):e.jsx(r,{lang:n})})};export{l as default};
